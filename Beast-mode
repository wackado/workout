import React, { useState } from ‚Äòreact‚Äô;
import { Calendar, Clock, Zap, Dumbbell, Activity, ChevronDown, ChevronUp, Play, Check } from ‚Äòlucide-react‚Äô;

const WorkoutBuilder = () => {
const [selectedWeek, setSelectedWeek] = useState(1);
const [selectedDay, setSelectedDay] = useState(‚Äòmonday‚Äô);
const [workoutSelections, setWorkoutSelections] = useState({});
const [expandedSections, setExpandedSections] = useState({});
const [completedExercises, setCompletedExercises] = useState({});

// Weekly frameworks
const weeklyFrameworks = {
1: {
monday: { type: ‚ÄòLower Body + SIT‚Äô, duration: 40, phases: [‚Äòjump‚Äô, ‚Äòstrength‚Äô, ‚Äòsit‚Äô] },
tuesday: { type: ‚ÄòPower + Jumps‚Äô, duration: 35, phases: [‚Äòjump‚Äô, ‚Äòpower‚Äô] },
wednesday: { type: ‚ÄòUpper Body + SIT‚Äô, duration: 40, phases: [‚Äòactivation‚Äô, ‚Äòstrength‚Äô, ‚Äòsit‚Äô] },
thursday: { type: ‚ÄòActive Recovery‚Äô, duration: 25, phases: [‚Äòmobility‚Äô, ‚Äòactivation‚Äô] },
friday: { type: ‚ÄòTotal Body + SIT‚Äô, duration: 40, phases: [‚Äòjump‚Äô, ‚Äòpower‚Äô, ‚Äòsit‚Äô] }
},
2: {
monday: { type: ‚ÄòTotal Body + SIT‚Äô, duration: 40, phases: [‚Äòjump‚Äô, ‚Äòpower‚Äô, ‚Äòsit‚Äô] },
tuesday: { type: ‚ÄòPower + Jumps‚Äô, duration: 35, phases: [‚Äòjump‚Äô, ‚Äòpower‚Äô] },
wednesday: { type: ‚ÄòLower Body + SIT‚Äô, duration: 40, phases: [‚Äòjump‚Äô, ‚Äòstrength‚Äô, ‚Äòsit‚Äô] },
thursday: { type: ‚ÄòActive Recovery‚Äô, duration: 25, phases: [‚Äòmobility‚Äô, ‚Äòactivation‚Äô] },
friday: { type: ‚ÄòUpper Body + SIT‚Äô, duration: 40, phases: [‚Äòactivation‚Äô, ‚Äòstrength‚Äô, ‚Äòsit‚Äô] }
},
3: {
monday: { type: ‚ÄòLower Body + SIT‚Äô, duration: 40, phases: [‚Äòjump‚Äô, ‚Äòstrength‚Äô, ‚Äòsit‚Äô] },
tuesday: { type: ‚ÄòJump + Strength‚Äô, duration: 40, phases: [‚Äòjump‚Äô, ‚Äòintegration‚Äô] },
wednesday: { type: ‚ÄòUpper Body + SIT‚Äô, duration: 40, phases: [‚Äòactivation‚Äô, ‚Äòstrength‚Äô, ‚Äòsit‚Äô] },
thursday: { type: ‚ÄòActive Recovery‚Äô, duration: 25, phases: [‚Äòmobility‚Äô, ‚Äòactivation‚Äô] },
friday: { type: ‚ÄòTotal Body + SIT‚Äô, duration: 40, phases: [‚Äòjump‚Äô, ‚Äòpower‚Äô, ‚Äòsit‚Äô] }
}
};

// Exercise options
const exerciseOptions = {
jump: [
{ name: ‚ÄòSquat Jump with Stick Landing‚Äô, reps: ‚Äò5 reps‚Äô, weight: ‚Äòbodyweight‚Äô, time: ‚Äò2 sets‚Äô },
{ name: ‚ÄòBroad Jump to Stabilization‚Äô, reps: ‚Äò3 reps‚Äô, weight: ‚Äòbodyweight‚Äô, time: ‚Äò2 sets‚Äô },
{ name: ‚ÄòStep-Up with Knee Drive‚Äô, reps: ‚Äò4 per leg‚Äô, weight: ‚Äòbodyweight‚Äô, time: ‚Äò2 sets‚Äô },
{ name: ‚ÄòDepth Jump to Vertical‚Äô, reps: ‚Äò4 reps‚Äô, weight: ‚Äòbodyweight‚Äô, time: ‚Äò3 sets‚Äô },
{ name: ‚ÄòLateral Bounds‚Äô, reps: ‚Äò4 per side‚Äô, weight: ‚Äòbodyweight‚Äô, time: ‚Äò3 sets‚Äô },
{ name: ‚ÄòSplit Jump to Tuck Jump‚Äô, reps: ‚Äò3 combos‚Äô, weight: ‚Äòbodyweight‚Äô, time: ‚Äò2 sets‚Äô }
],
strength: [
{ name: ‚ÄòDumbbell Goblet Squat‚Äô, reps: ‚Äò6-8 reps‚Äô, weight: ‚Äò25 lbs‚Äô, time: ‚Äò4 sets‚Äô },
{ name: ‚ÄòSingle-Leg Romanian Deadlift‚Äô, reps: ‚Äò6 per leg‚Äô, weight: ‚Äò15 lbs each‚Äô, time: ‚Äò4 sets‚Äô },
{ name: ‚ÄòBulgarian Split Squats‚Äô, reps: ‚Äò8 per leg‚Äô, weight: ‚Äò10-15 lbs each‚Äô, time: ‚Äò3 sets‚Äô },
{ name: ‚ÄòSingle-Arm Dumbbell Row‚Äô, reps: ‚Äò8 per arm‚Äô, weight: ‚Äò15-25 lbs‚Äô, time: ‚Äò4 sets‚Äô },
{ name: ‚ÄòDumbbell Floor Press‚Äô, reps: ‚Äò8 reps‚Äô, weight: ‚Äò15 lbs each‚Äô, time: ‚Äò4 sets‚Äô },
{ name: ‚ÄòRenegade Rows‚Äô, reps: ‚Äò6 per arm‚Äô, weight: ‚Äò10 lbs each‚Äô, time: ‚Äò3 sets‚Äô }
],
power: [
{ name: ‚ÄòDumbbell Snatch‚Äô, reps: ‚Äò5 per arm‚Äô, weight: ‚Äò10-15 lbs‚Äô, time: ‚Äò3 rounds‚Äô },
{ name: ‚ÄòJump Squat with Dumbbells‚Äô, reps: ‚Äò8 reps‚Äô, weight: ‚Äò5-10 lbs each‚Äô, time: ‚Äò3 rounds‚Äô },
{ name: ‚ÄòDumbbell Thruster‚Äô, reps: ‚Äò8 reps‚Äô, weight: ‚Äò10-15 lbs each‚Äô, time: ‚Äò3 rounds‚Äô },
{ name: ‚ÄòHeavy Dumbbell Swings‚Äô, reps: ‚Äò20 reps‚Äô, weight: ‚Äò25 lbs‚Äô, time: ‚Äò3 rounds‚Äô }
],
sit: [
{ name: ‚ÄòDumbbell Thrusters‚Äô, reps: ‚Äò30 sec work‚Äô, weight: ‚Äò10-15 lbs each‚Äô, time: ‚Äò3 rounds‚Äô, duration: 3 },
{ name: ‚ÄòBurpee Complex‚Äô, reps: ‚Äò30 sec work‚Äô, weight: ‚Äòbodyweight‚Äô, time: ‚Äò3 rounds‚Äô, duration: 3 },
{ name: ‚ÄòHeavy Dumbbell Swings‚Äô, reps: ‚Äò30 sec work‚Äô, weight: ‚Äò25 lbs‚Äô, time: ‚Äò3 rounds‚Äô, duration: 3 },
{ name: ‚ÄòMountain Climber Intervals‚Äô, reps: ‚Äò20 sec work‚Äô, weight: ‚Äòbodyweight‚Äô, time: ‚Äò4 rounds‚Äô, duration: 2.5 },
{ name: ‚ÄòJump Squat Intervals‚Äô, reps: ‚Äò30 sec work‚Äô, weight: ‚Äòbodyweight‚Äô, time: ‚Äò3 rounds‚Äô, duration: 3 },
{ name: ‚ÄòFast Push-Ups‚Äô, reps: ‚Äò20 sec work‚Äô, weight: ‚Äòbodyweight‚Äô, time: ‚Äò4 rounds‚Äô, duration: 2.5 }
],
activation: [
{ name: ‚ÄòArm Swings with Rotation‚Äô, reps: ‚Äò8 each direction‚Äô, weight: ‚Äòbodyweight‚Äô, time: ‚Äò2 rounds‚Äô },
{ name: ‚ÄòLight Squat Jumps‚Äô, reps: ‚Äò4 reps‚Äô, weight: ‚Äòbodyweight‚Äô, time: ‚Äò2 rounds‚Äô },
{ name: ‚ÄòShoulder Blade Squeezes‚Äô, reps: ‚Äò8 reps‚Äô, weight: ‚Äòbodyweight‚Äô, time: ‚Äò2 rounds‚Äô }
],
mobility: [
{ name: ‚ÄòCat-Cow Stretches‚Äô, reps: ‚Äò8 reps‚Äô, weight: ‚Äòbodyweight‚Äô, time: ‚Äò3 rounds‚Äô },
{ name: ‚ÄòHip Flexor Stretch‚Äô, reps: ‚Äò30 sec each‚Äô, weight: ‚Äòbodyweight‚Äô, time: ‚Äò3 rounds‚Äô },
{ name: ‚ÄòGlute Bridge Hold‚Äô, reps: ‚Äò30 seconds‚Äô, weight: ‚Äòbodyweight‚Äô, time: ‚Äò3 rounds‚Äô }
],
integration: [
{ name: ‚ÄòGoblet Squat to Jump Squat‚Äô, reps: ‚Äò6+3 combo‚Äô, weight: ‚Äò25 lbs + bodyweight‚Äô, time: ‚Äò4 sets‚Äô },
{ name: ‚ÄòRow to Fast Thrusters‚Äô, reps: ‚Äò8+8 combo‚Äô, weight: ‚Äò15 lbs + 10 lbs‚Äô, time: ‚Äò3 sets‚Äô }
]
};

// Helper functions
const getCurrentWorkout = () => {
return weeklyFrameworks[selectedWeek]?.[selectedDay] || {};
};

const getSelectedSITTime = () => {
const selectedExercises = Object.entries(workoutSelections)
.filter(([key, exercise]) =>
key.startsWith(`${selectedWeek}-${selectedDay}-sit`) && exercise
)
.map(([, exercise]) => exercise);

```
return selectedExercises.reduce((total, exercise) => total + (exercise.duration || 0), 0);
```

};

const getSelectedCount = (phase) => {
return Object.keys(workoutSelections).filter(key =>
key.startsWith(`${selectedWeek}-${selectedDay}-${phase}`) && workoutSelections[key]
).length;
};

const getPhaseTitle = (phase) => {
const titles = {
jump: ‚ÄòJump Training (5 min)‚Äô,
strength: ‚ÄòStrength Training (25 min)‚Äô,
power: ‚ÄòPower Circuits (18 min)‚Äô,
sit: ‚ÄòSIT Finisher (8 min)‚Äô,
activation: ‚ÄòNeural Activation (4 min)‚Äô,
mobility: ‚ÄòMobility Work (15 min)‚Äô,
integration: ‚ÄòStrength Integration (24 min)‚Äô
};
return titles[phase] || phase;
};

const getPhaseIcon = (phase) => {
const icons = {
jump: <Zap className="w-5 h-5 text-yellow-500" />,
strength: <Dumbbell className="w-5 h-5 text-blue-500" />,
power: <Activity className="w-5 h-5 text-red-500" />,
sit: <Zap className="w-5 h-5 text-purple-500" />,
activation: <Play className="w-5 h-5 text-green-500" />,
mobility: <Activity className="w-5 h-5 text-teal-500" />,
integration: <Dumbbell className="w-5 h-5 text-orange-500" />
};
return icons[phase] || <Activity className="w-5 h-5" />;
};

const getPhaseInstructions = (phase, workoutType) => {
const instructions = {
jump: workoutType === ‚ÄòPower + Jumps‚Äô
? ‚ÄòSelect 4-6 exercises (Extended Jump Training - 15 min)‚Äô
: ‚ÄòSelect 2-3 exercises (Quick Neural Primer - 5 min)‚Äô,
strength: ‚ÄòSelect 3-4 exercises (Focus on compound movements)‚Äô,
power: ‚ÄòSelect 3-4 exercises (Explosive, full-body movements)‚Äô,
sit: ‚ÄòSelect multiple exercises totaling ~8 minutes (High-intensity intervals)‚Äô,
activation: ‚ÄòSelect 2-3 exercises (Light neural activation)‚Äô,
mobility: ‚ÄòSelect 3-5 exercises (Movement quality focus)‚Äô,
integration: ‚ÄòSelect 2-3 exercise combinations (Strength + power pairs)‚Äô
};
return instructions[phase] || ‚Äò‚Äô;
};

const getMaxSelections = (phase, workoutType) => {
if (phase === ‚Äòjump‚Äô) {
return workoutType === ‚ÄòPower + Jumps‚Äô ? 6 : 3;
}
if (phase === ‚Äòsit‚Äô) return 10;
if (phase === ‚Äòactivation‚Äô) return 3;
return 4;
};

// Event handlers
const handleExerciseSelect = (phase, exercise) => {
const exerciseKey = `${selectedWeek}-${selectedDay}-${phase}-${exercise.name}`;
const isCurrentlySelected = workoutSelections[exerciseKey];

```
if (phase === 'sit') {
  const currentTime = getSelectedSITTime();
  if (!isCurrentlySelected && currentTime + (exercise.duration || 0) > 10) {
    return;
  }
} else {
  const maxSelections = getMaxSelections(phase, getCurrentWorkout().type);
  const currentCount = getSelectedCount(phase);
  if (!isCurrentlySelected && currentCount >= maxSelections) {
    return;
  }
}

setWorkoutSelections(prev => ({
  ...prev,
  [exerciseKey]: isCurrentlySelected ? null : exercise
}));
```

};

const handleExerciseComplete = (exerciseKey) => {
setCompletedExercises(prev => ({
‚Ä¶prev,
[exerciseKey]: !prev[exerciseKey]
}));
};

const toggleSection = (section) => {
setExpandedSections(prev => ({
‚Ä¶prev,
[section]: !prev[section]
}));
};

const currentWorkout = getCurrentWorkout();
const dayNames = [‚Äòmonday‚Äô, ‚Äòtuesday‚Äô, ‚Äòwednesday‚Äô, ‚Äòthursday‚Äô, ‚Äòfriday‚Äô];

return (
<div className="max-w-4xl mx-auto p-6 bg-gray-50 min-h-screen">
<div className="bg-white rounded-lg shadow-lg p-6 mb-6">
<h1 className="text-3xl font-bold text-gray-800 mb-2 flex items-center gap-2">
<Calendar className="text-blue-500" />
Workout Builder - Dr. Sims Method
</h1>
<p className="text-gray-600">Choose your framework, then customize your exercises</p>
</div>

```
  {/* Week and Day Selection */}
  <div className="bg-white rounded-lg shadow-lg p-6 mb-6">
    <div className="grid md:grid-cols-2 gap-6">
      <div>
        <label className="block text-sm font-medium text-gray-700 mb-2">Select Week Pattern</label>
        <select 
          value={selectedWeek} 
          onChange={(e) => setSelectedWeek(Number(e.target.value))}
          className="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
        >
          <option value={1}>Week 1 - Foundation Pattern</option>
          <option value={2}>Week 2 - Power Emphasis</option>
          <option value={3}>Week 3 - Lower Body Focus</option>
        </select>
      </div>
      
      <div>
        <label className="block text-sm font-medium text-gray-700 mb-2">Select Day</label>
        <select 
          value={selectedDay} 
          onChange={(e) => setSelectedDay(e.target.value)}
          className="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
        >
          {dayNames.map(day => (
            <option key={day} value={day}>
              {day.charAt(0).toUpperCase() + day.slice(1)}
            </option>
          ))}
        </select>
      </div>
    </div>
  </div>

  {/* Current Workout Overview */}
  <div className="bg-white rounded-lg shadow-lg p-6 mb-6">
    <div className="flex items-center justify-between mb-4">
      <h2 className="text-xl font-semibold text-gray-800 flex items-center gap-2">
        <Clock className="text-blue-500" />
        {selectedDay.charAt(0).toUpperCase() + selectedDay.slice(1)}: {currentWorkout.type}
      </h2>
      <span className="bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-sm font-medium">
        {currentWorkout.duration} minutes
      </span>
    </div>
    
    <div className="flex flex-wrap gap-2">
      {currentWorkout.phases?.map((phase, index) => (
        <span key={index} className="bg-gray-100 text-gray-700 px-3 py-1 rounded-full text-sm flex items-center gap-1">
          {getPhaseIcon(phase)}
          {getPhaseTitle(phase)}
        </span>
      ))}
    </div>
  </div>

  {/* Exercise Selection */}
  <div className="space-y-4">
    {currentWorkout.phases?.map((phase) => {
      const isExpanded = expandedSections[phase];
      const selectedTime = phase === 'sit' ? getSelectedSITTime() : 0;
      const selectedCount = getSelectedCount(phase);
      const maxSelections = getMaxSelections(phase, currentWorkout.type);
      
      return (
        <div key={phase} className="bg-white rounded-lg shadow-lg">
          <div 
            className="p-4 cursor-pointer flex items-center justify-between hover:bg-gray-50"
            onClick={() => toggleSection(phase)}
          >
            <div className="flex items-center gap-3">
              {getPhaseIcon(phase)}
              <div>
                <h3 className="text-lg font-semibold text-gray-800">
                  {getPhaseTitle(phase)}
                </h3>
                <p className="text-sm text-gray-600">
                  {getPhaseInstructions(phase, currentWorkout.type)}
                </p>
              </div>
              {phase === 'sit' ? (
                <span className={`px-2 py-1 rounded text-sm ml-auto mr-2 ${
                  selectedTime >= 7 && selectedTime <= 9 
                    ? 'bg-green-100 text-green-800' 
                    : selectedTime > 9
                      ? 'bg-red-100 text-red-800'
                      : 'bg-blue-100 text-blue-800'
                }`}>
                  {selectedTime} min / 8 min target
                </span>
              ) : (
                <span className="bg-blue-100 text-blue-800 px-2 py-1 rounded text-sm ml-auto mr-2">
                  {selectedCount}/{maxSelections} selected
                </span>
              )}
            </div>
            {isExpanded ? <ChevronUp /> : <ChevronDown />}
          </div>
          
          {isExpanded && (
            <div className="border-t p-4">
              <div className="grid gap-3">
                {exerciseOptions[phase]?.map((exercise, i) => {
                  const exerciseKey = `${selectedWeek}-${selectedDay}-${phase}-${exercise.name}`;
                  const isSelected = workoutSelections[exerciseKey];
                  const isCompleted = completedExercises[exerciseKey];
                  
                  let canSelect = true;
                  if (phase === 'sit') {
                    canSelect = isSelected || (selectedTime + (exercise.duration || 0) <= 10);
                  } else {
                    canSelect = isSelected || selectedCount < maxSelections;
                  }
                  
                  return (
                    <div 
                      key={i}
                      className={`p-3 border rounded-lg transition-all ${
                        isSelected 
                          ? 'border-blue-500 bg-blue-50' 
                          : canSelect 
                            ? 'border-gray-200 hover:border-gray-300 cursor-pointer'
                            : 'border-gray-100 bg-gray-50 cursor-not-allowed opacity-50'
                      } ${isCompleted ? 'bg-green-50 border-green-300' : ''}`}
                      onClick={() => canSelect && handleExerciseSelect(phase, exercise)}
                    >
                      <div className="flex items-center justify-between">
                        <div>
                          <h4 className={`font-medium ${isCompleted ? 'line-through text-gray-500' : 'text-gray-800'}`}>
                            {exercise.name}
                          </h4>
                          <div className="text-sm text-gray-600 flex gap-4">
                            <span>üìä {exercise.reps}</span>
                            <span>‚öñÔ∏è {exercise.weight}</span>
                            <span>‚è±Ô∏è {exercise.time}</span>
                            {phase === 'sit' && exercise.duration && (
                              <span className="text-blue-600 font-medium">üïê {exercise.duration} min</span>
                            )}
                          </div>
                        </div>
                        {isSelected && (
                          <button
                            onClick={(e) => {
                              e.stopPropagation();
                              handleExerciseComplete(exerciseKey);
                            }}
                            className={`p-2 rounded-full ${
                              isCompleted 
                                ? 'bg-green-500 text-white' 
                                : 'bg-gray-200 text-gray-600 hover:bg-gray-300'
                            }`}
                          >
                            <Check className="w-4 h-4" />
                          </button>
                        )}
                      </div>
                    </div>
                  );
                })}
              </div>
            </div>
          )}
        </div>
      );
    })}
  </div>

  {/* Workout Summary */}
  {Object.values(workoutSelections).some(exercise => exercise) && (
    <div className="bg-white rounded-lg shadow-lg p-6 mt-6">
      <h3 className="text-lg font-semibold text-gray-800 mb-4">Your Custom Workout Summary</h3>
      <div className="space-y-3">
        {currentWorkout.phases?.map((phase) => {
          const selectedExercises = Object.entries(workoutSelections)
            .filter(([key, exercise]) => 
              key.startsWith(`${selectedWeek}-${selectedDay}-${phase}`) && exercise
            )
            .map(([key, exercise]) => ({ key, exercise }));
          
          if (selectedExercises.length === 0) return null;
          
          return (
            <div key={phase} className="border-l-4 border-blue-500 pl-4">
              <div className="flex items-center gap-2 mb-2">
                {getPhaseIcon(phase)}
                <span className="font-medium text-gray-800">
                  {getPhaseTitle(phase)}
                </span>
              </div>
              <div className="space-y-1">
                {selectedExercises.map(({ key, exercise }) => {
                  const isCompleted = completedExercises[key];
                  return (
                    <div key={key} className={`flex items-center gap-3 p-2 rounded ${isCompleted ? 'bg-green-50' : ''}`}>
                      <span className={`text-sm ${isCompleted ? 'line-through text-gray-500' : 'text-gray-800'}`}>
                        ‚Ä¢ {exercise.name}
                      </span>
                      <span className="text-xs text-gray-600">
                        {exercise.reps} ‚Ä¢ {exercise.weight}
                      </span>
                      {isCompleted && <Check className="w-3 h-3 text-green-500 ml-auto" />}
                    </div>
                  );
                })}
              </div>
            </div>
          );
        })}
      </div>
    </div>
  )}
</div>
```

);
};

export default WorkoutBuilder;
